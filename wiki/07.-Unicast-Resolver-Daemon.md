# Introduction

The Unicast Resolver Daemon is the central piece of the topic resolving when unicast configuration is selected.

The best solution for topic resolution is to always use multicast, unfortunately not all the environments have support for multicast and in some cases it may be necessary to use an unicast solution.

The Unicast Daemon is a very simple piece of code that centralises all the topic resolution traffic and distribute it to the rest of the clients in the system.

The Daemon has a fixed unicast reception port where it listen for events generated by the clients. Each client publish the subscriber socket information where it will receive messages from the Daemon. The Daemon therefore will create a new sender socket per client to clone al republish all the information received, broadcasting the adverts to all the clients.

**Important**: The current version has no support for multiple daemons for redundancy, this means the daemon is a single point of failure in the system and should not be used on production environments.

![Unicast Daemon](https://github.com/BBVA-CIB/Vega-Messaging/blob/master/wiki/aeronunicasttopicadvertdaemon.png)

# Launching the daemon

The daemon is contained inside the same Jar file of the VegaLibrary.

The launcher is included in the class _com.bbva.kyof.vega.daemon.UnicastDaemonLauncher_

To launch the Daemon just call: java -cp _{classpath}_ com.bbva.kyof.vega.daemon.UnicastDaemonLauncher _{parameters}_

_{classpath}_ - Is the Java classpath that should contain the VegaLibrary Jar and it's dependencies.
_{parameters}_ - Are the parameters for the launcher

## Launcher parameters

* **Comunication Port (Optional)**
* * Usage: -p {port} or -port {port}
* * Default value: 40300
* * Is the UPD port that will be used to receive adverts from the clients.
* **Alternative unicast Hostname (Optional)**
* * Usage: -hn {hostname} or -hostname {hostname}
* * Default value: ''
* * Is the alternative Hostname to configure and to be used in virtual environment as docker. With this hostname, URD can resolve the correct address when host is shared between 
    VegaInstances.
* **Resolve hostname flag (Optional)**
* * Usage: -rhn or -resolveHostname
* * False by default
* * (Optional) Resolve hostname from clients to get ip address. Related with virtual environment as docker. If a client is in a different hostname, URD try to resolve public address by hostname. 
    NOTE: If flag is active and alternative hostname is not configured, alternative hostname is going to be set by default hostname from subnet.
* **Subnet Address (Optional)**
* * Usage: -sn {subnet} or -subnet {subnet}
* * By default it will use the subnet of the first found interface address.
* * The format is 192.168.1.0/24, with the subnet address and the mask
* * The provided subnet address will be used to select the network interface to use for the communications
* **External Driver Directory (Optional)**
* * Usage: -exdd {dirPath} or - driverDirectory {dirPath}
* * False by default
* * It is used to provide the media driver directory when an external media driver is used.
* * If not provided and external media driver is used, it will use the default driver directory.
* **Use Embedded Media Driver (Optional)**
* * Usage: -ed or -embeddedDriver
* * False by default
* * Set to true to use an embedded media driver.
* **Use Embedded LowLatency Media Driver (Optional)**
* * Usage: -edll or -embeddedDriverLowLatency
* * False by default
* * Set to true to use an embedded media driver optimised for LowLatency
* **Embedded Media Driver Configuration File (Optional)**
* * Usage: -edcf {configFilePath} or -embeddedDriverConfigFile {configFilePath}
* * Select an Aeron Media Driver configuration file to use in order to configure the embedded driver when embedded media driver is used.
* * If not settled it will use the default driver values.
* **Client Timeout (Optional)**
* * Usage: -ct {timeoutValue} or -clientTimeout{timeoutValue}
* * Default value 10000. 10 Seconds.
* * Value in milliseconds that the daemon will wait between consecutive messages from a client before considering the client disconnected-